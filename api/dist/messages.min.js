"use strict";var connectToDatabase=require("../db"),Message=require("../models/Message");module.exports=function(r,s){var a,t,n,o,c,g;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(connectToDatabase());case 2:if("GET"===r.method)return e.prev=3,e.next=6,regeneratorRuntime.awrap(Message.find().sort({timestamp:1}));e.next=16;break;case 6:a=e.sent,s.status(200).json(a),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(3),console.error("Error fetching messages:",e.t0),s.status(500).json({error:"Error fetching messages",details:e.t0.message});case 14:e.next=45;break;case 16:if("POST"===r.method)return e.prev=17,t=r.body,n=t.username,o=t.message,c=t.mediaUrl,g=new Message({username:n,message:o,mediaUrl:c}),e.next=22,regeneratorRuntime.awrap(g.save());e.next=31;break;case 22:s.status(201).json(g),e.next=29;break;case 25:e.prev=25,e.t1=e.catch(17),console.error("Error saving message:",e.t1),s.status(500).json({error:"Error saving message",details:e.t1.message});case 29:e.next=45;break;case 31:if("DELETE"===r.method)return e.prev=32,e.next=35,regeneratorRuntime.awrap(Message.deleteMany({}));e.next=44;break;case 35:s.status(200).json({message:"All messages cleared"}),e.next=42;break;case 38:e.prev=38,e.t2=e.catch(32),console.error("Error deleting messages:",e.t2),s.status(500).json({error:"Error deleting messages",details:e.t2.message});case 42:e.next=45;break;case 44:s.status(405).json({error:"Method Not Allowed"});case 45:case"end":return e.stop()}},null,null,[[3,10],[17,25],[32,38]])};
//# sourceMappingURL=messages.min.js.map
